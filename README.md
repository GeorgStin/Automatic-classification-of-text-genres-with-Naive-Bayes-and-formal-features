# Автоматическая классификация жанров в текстах

Этот репозиторий описывает жанровый классификатор, который различает научные тексты и художественную литературу на русском и немецком языках. Программа написана на Python. Для обучения классификатора использовался наивный Байес и набор простых, формальных признаков текста. 

---

## 1. Идея и цели проекта

- **Задача:** бинарная классификация документов (science vs. fiction).  
- **Языки:** немецкий (de) и русский (ru), сбалансированные текстовые корпусы по жанрам.  
- **Модель:** наивный Байес с гауссовским распределением по 7 статистическим признакам.  
- **Цель:** показать, что жанры можно разделять на основе простых, интерпретируемых признаков, а также продемонстрировать навыки в области NLP, классического ML и обработки лингвистических корпусов.

---

## Какие умения показаны в этом проекте

- **Создание языкового корпуса и работа с мультиязычными данными**
- Создание сбалансированного корпуса для немецкого и русского языков.
- Согласование научных тем и использование одинаковых художественных произведений на обоих языках.

- **Предварительная обработка текста**  
  - Сегментация предложений с помощью токенизатора Punkt (NLRK) и настраиваемых правил для аббревиатур и кавычек.  
  - Ручная очистка документов для сохранения только «голого текста» (без таблиц, рисунков, верхних и нижних колонтитулов или ссылок).

- **Разработка функций для классического NLP**  
  - Разработка и реализация семи формальных интерпретируемых параметров для анализа текста.

- **Моделирование и оценивание (evaluation)**  
  - Обучение [Гауссовского байесовского классификатора](https://en.wikipedia.org/wiki/Naive_Bayes_classifier "Википедия") на 7-мерных векторах текстовых параметров.  
  - 4-кратная кросс-валидация (75% текстов для обучения, 25% для тестирования - 4 раза) для обоих языков.
  - Критическая оценка точности классификатора.

- **Анализ и лингвистические выводы**  
  - Анализ разделения жанров по признакам с помощью статистических диаграмм (между жанрами и между языками).  
  - Идентификация надежных параметров, применимых вне зависимости от языка.  
  - Обсуждение языковых особенностей (например, влияние артиклей в немецком).

---

## 2. Как устроен классификатор (научная часть)

### 2.1. Данные

В экспериментах используется 64 текста:

- 16 немецких научных текстов из разных дисциплин.  
- 16 немецких художественных текстов (романы разных авторов и эпох).  
- 16 русских научных текстов в соответствующих областях.  
- 16 русских художественных текстов, соответствующих немецкому списку романов.  

Тексты очищены от заголовков, таблиц, рисунков, сносок и других не-текстовых элементов, а также логически укорочены (например, по главам) без разрыва предложений.

Из-за авторского права исходные тексты не включены в этот репозиторий; вместо этого используются:

- Список источников в виде путей к файлам (например, `Science/01.txt`, `Fiction/01_Martin.txt`, `Science_ru/01.txt`, `Fiction_ru/01.txt` и т. д.).  
- Предобученные датасеты признаков `dataset_de.txt` и `dataset_ru.txt`, содержащие натренированные векторы каждого отдельного текста.  

### 2.2. Признаки

Каждый текст описывается 7-мерным вектором признаков:

| # | Признак                              | Идея                                                                      |
|---|--------------------------------------|---------------------------------------------------------------------------|
| 1 | Средняя длина слова                  | Длинные слова более типичны для научного стиля                            |
| 2 | Среднее кол-во длинных слов в предложении    | В научных текстах используются больше терминов                    |
| 3 | Коэффициент лексического разнообразия (TTR)  | Измеряет лексическое разнообразие в каждом тексте                 |
| 4 | Относительная доля [hapax legomena](https://ru.wikipedia.org/wiki/%D0%93%D0%B0%D0%BF%D0%B0%D0%BA%D1%81 "Википедия")  | В художественной литературе, как правило, более разнообразен словарный запас            |
| 5 | Среднее кол-во слов в предложении           | Показатель синтаксической сложности                                    |
| 6 | Среднее кол-во запятых в предложении          | Дополнительный синтаксический индикатор                              |
| 7 | Относительная доля личных местоимений          | В художественной литературе используется гораздо больше местоимений               |

Самыми устойчивыми и сильными признаками оказались средняя длина слова (1), доля длинных слов (2), длина предложения (5) и доля личных местоимений (7); признак «запятые на предложение» показал себя шумным и сильно зависящим от языка.

<details>
    <summary>Результаты</summary>
    графики
    </details>

### 2.3. Модель и оценка

- **Классификатор:** наивный Байес с предположением нормального распределения признаков в каждом классе.  
- **Оценка:** 4-кратная кросс-валидация (75% текстов в обучении, 25% в тесте на каждом фолде).  
- **Результат:** на данном контролируемом корпусе ни один текст не был классифицирован неверно (наблюдаемая точность 100%).  

 <details>
    <summary>(идеальная точность?)</summary>
Такой результат не должен вводить в заблуждение. Все 64 текста были подготовлены вручную, что требует определенных временных затрат. Кроме того, все тексты были достаточно длинными и, следовательно, имели качественные и сбалансированные наборы признаков (как для обучения классификатора, так и для самой классификации).
     
100%-ная точность соответствует поставленным задачам:
  1) Было показано, что выбранный классификатор работает правильно и точно.
  2) Было доказано, что выбранные жанры имеют четкие формальные различия.
  
Если бы целью было внедрение максимально точного и эффективного классификатора, то сначала было бы логично проанализировать характеристики и ограничиться только эффективными параметрами. В этом случае следует провести оценку с использованием неподходящих (неидеальных) тестовых данных и сравнить классификатор с конкурирующими системами.
</details>
    
---

## 3. Как запустить: режимы и параметры

Командный интерфейс реализован в виде единого скрипта (`class.py`) с двумя основными режимами:

- `train` — обучение и дополнение датасета признаков.  
- `classify` — классификация одного или нескольких текстов.  

Примеры вызова из командной строки:

```
python script.py classify dataset_de.txt Science/01.txt de None
```
```
python script.py train my_dataset.txt Science_de de science
```
